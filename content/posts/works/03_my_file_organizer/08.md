---
title: "[ファイル整理ツール08]PDFファイルのみ他フォルダに分類する[Python]"
date: 2021-06-05T07:00:00
lead: ""
categories: 
    - "MyTools"
tags: 
    - "ツール制作"
---

## はじめに
今回は イシュー#4。  
これで一旦ラストになります。　　

[PDFファイル · Issue #4 · Massasquash/MyFileOrganizer · GitHub](https://github.com/Massasquash/MyFileOrganizer/issues/4)

- 拡張子によって指定のフォルダに移動させる関数を作る
  - 今回は、インプットフォルダの「ダウンロード」を対象に、PDFファイルを「PDF」フォルダに移動する
  - 今回は、同フォルダに移動するのみとする


## 1. まとめたい拡張子を記述しておくグローバル定数を用意する
今回はpdfファイルのみをフォルダにまとめたいのですが、今後増やせるようにグローバル定数としてリストに持たせるようにしました。  

```python
EXTENCIONS = ['pdf']
```

## 2. 実装の方針
ちょっと設計的に、リネームとフォルダ分けを同時にやってしまうような設計にしてしまってるので、今回の実装があまりうまくないかもしれません。  

`rename_and_devide_files`関数の最初の方でまずこの拡張子を持つものを抽出して、ごそっと別の関数に渡してしまう、というような実装がやりやすいのかなと思いました。  


## 3. move_file_by_extension関数を作成する
拡張子によってフォルダに格納する関数を作ります。  
`new_path.suffix`は拡張子のドットを含む文字列になるので、必要な部分のみスライスで抽出。

```python
def move_file_by_extension(path):
    """拡張子によってフォルダに分類する関数。
    - 拡張子と同じ名前のフォルダにまとめる
    
    Args:
        path(pathlib.Path): パスオブジェクト
    """
    new_path = rename_path_add_prefix(path)
    to_dir = new_path.parent / new_path.suffix[1:]
    
    move_file_to_folder(new_path, to_dir)
```

## 3. 関数から呼び出すようにする
`rename_add_devide_diles`関数実行時に、ファイル拡張子が`EXTENCIONS`の要素と合致するかどうかをチェックし、合致した場合は先ほど作成した`move_file_by_extension`関数にパスを渡すようにします。  

```python
def rename_and_devide_files():
    """インプットファイルのリネームとフォルダ分けを行う処理"""
    for in_folder in IN_PATHS:
        contents = in_folder.iterdir()

        for content in contents:
            name = content.name
            # 下記１行追加
            suffix = content.suffix[1:]

            if name == '.DS_Store':
                continue

            # 下記３行追加
            if suffix in EXTENCIONS:
                move_file_by_extension(content)
                continue

            if re.compile(r'^(\d{6})$').search(name):
                continue

            （省略）
```


## おわりに


### MEMO
今回の実装  
- Issue #5 完了

次回の実装
- Issue #4を実装して、ひとまず完成に持っていけるかなー
  - [PDFファイル · Issue #4 · Massasquash/MyFileOrganizer · GitHub](https://github.com/Massasquash/MyFileOrganizer/issues/4)
　
### GitHub
- [GitHub - Massasquash/MyFileOrganizer](https://github.com/Massasquash/MyFileOrganizer)
