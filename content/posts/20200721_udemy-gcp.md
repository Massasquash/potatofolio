---
title: "[Udemy]現役エンジニアが教える、手を動かして学ぶGoogle Cloud Platform(GCP) 入門"
date: 2020-07-21
lead: "色々なGCPサービスの概要を掴む"
categories:
  - "学習ノート"
images: "img/page_logo.jpg"
---

# はじめに
以下の動画でGCPの概要を学習。  
[現役エンジニアが教える、手を動かして学ぶGoogle Cloud Platform(GCP) 入門 \| Udemy](https://www.udemy.com/course/google-cloud-platform-gcp/)

動画は2019年2月〜4月作成のようで若干情報が古いと思われるので、注意が必要です。

各サービスは概要を掴む目的でまとめてみます。

## GCPとは？
- Googleのインフラと同じものをコスパよく使えるインフラサービス。

|  TH  |  TH  |
| ---- | ---- |
|  Compute Engine(GCE)  |  IaaS, 仮想マシンを提供するサービス  |
|  Cloud Functions  |  サーバレスのランタイム環境を提供。関数をクラウド上で動作可能に  |
|  Cloud Datastore  |  NoSQLのデータベースを提供するサービス  |
|  App Engine(GAE)  |  Paas,　Webアプリ開発・ホスティングのプラットフォームを提供するさーびす |
|  Cloud External IP Addresses  |  ??  |
|  Cloud SQL  |  RDBの設定・運用・管理サービス  |
|  Cloud IAM  |  ??  |
|  Cloud Storage(GCS)  |  クラウド上にデータを保存して共有できるストレージサービス  |
|  Cloud Load Balancing(GLB)  |  ロードバランサ（負荷分散装置）を提供するサービス  |
|  Cloud DNS  |  DNSの機能を提供するサービス  |

### GCPのHome画面
＜左の欄＞
- プロジェクトの情報
- リソース：このプロジェクトで使っているインスタンスやサービスの情報など
- トレース：レイテンシーの情報などが見れる（データ転送における通信の遅延）

＜真ん中の欄＞
右上の「カスタマイズ」で必要なもののみ表示することができる

＜右の欄＞
- Error Reporting：エラー情報がここで見られる

### 請求画面・請求アラートの設定
インスタンスの消し忘れによって月末に高額支払いがきてしまう可能性があるので、それを防ぐ

- 左上の「ナビゲーションメニュー」より「お支払い」
- 「予算とアラート」から「予算を作成」

### Pub/Subトピック
「Pub/Subトピックをこの予算に接続する」にチェックを入れると、そこにデータが入り、それをトリガーにしてSlackに飛ばすなりなんなりを設定できる
Pub/Subとはキューみたいなもの。？

### 無料枠と料金の見積もり方法
[GCP の無料枠 - 無料の長期トライアル、Always Free  \|  Google Cloud](https://cloud.google.com/free)

- アカウント新規作成時は、１年間300$だけ無料で使えるクレジットがもらえる
- Allways Freeプロダクトを使うと、完全無料でサービスを運用することができる
- 以下のページで見積もりを出すことができる

[Google Cloud Platform 料金計算ツール](https://cloud.google.com/products/calculator)

### プロジェクトのシャットダウン
- インスタンスがたくさんあっても、プロジェクトをシャットダウンすることで課金が止められる


## Cloud Shellとは？
- PCに入ってるターミナルのクラウド版、というようなイメージ。
- 無料で使えて、bash, sh, emacs, vim, MySQLクライアント, kubernetes, Dockerなどのコマンドラインツールがデフォルトで入っている
- GCPのSDK(gcloudコマンド)をインストールせずそのまま使用することができる
- ほぼLinuxと同様の操作

右上の「Cloud Shellをアクティブにする」をクリックして、最初は１〜２分たてば使えるようになる（プロビジョニング）

- Cloud Shellの右上の「縦三点アイコン」から、ローカルのファイルをアップロードしたりできる
- 「エディタを開く」 <--> 「ターミナルを開く」

## Google Compute Engine(GCE)
- 自分が好きなスペックのサーバーを秒単位で使用できる（好きな時に作れて好きな時に壊せる）
- 課金は秒単位、継続利用割引（使えば使うだけ安くなる）

●**IaaS（Infracture as a Service)**：
仮想化技術を利用して、ハードウェアリソース（CPU/メモリ/ストレージ）などのITインフラをクラウド上（インターネット経由）で利用できるサービス。

## Google Cloud Storage(GCS)
- バックアップや画像、動画の置き場として利用されるオブジェクトストレージ。
- GCSで画像を一般公開（URLを生成）し、GCEからアクセスする、ということができる
- 課金体系：アクセス頻度により４種類のストレージクラスから選択する

●用語：
バケット：ファイルを格納するコンテナ
オブジェクト：格納されるファイル

## Cloud SQL
- フルマネージドのPostgreSQLとMySQL。
- これを使うことで、DBサーバーの管理が不要になり、アプリ作成に手中できる
- GCEやGAEから接続してデータベースを利用できる
- 課金は秒単位、継続利用割引（使えば使うだけ安くなる）

## Instance Group
- インスタンスの数を自動で増減（スケール）できる
- インスタンスの数は最小、最大を指定する。CPU使用率などを基準にできる

●スケールするGCEを作れる：
最初は１代のGCE（インスタンス）を使用し、トラフィックが増えたら３台に増やし、トラフィックが減ったら１台に減らす…とすることで、急激なトラフィックへの対応、コスト削減ができる。

●用語：
スケールアウト/スケールイン：サーバーの台数を増やして処理性能を高めること。のInstance Groupではこの方法でスケーリングを行う。
（スケールアップ：こちらもスケーリングの方法だが、こちらはサーバーのCPUやメモリーなどをスペックアップすることで処理性能を高めること）
イメージ：GCEのブートディスク（中の情報）。スケールアウトする時に新しいインスタンスの元になるもの。
インスタンス：
トラフィック：

## Cloud Load Balancing（GLB）
- 世界規模の自動のスケーリングと負荷分散。大規模なトラフィックにも耐えられるシステムを作ることができる。
- HTTP, TCPなど各レイヤーごとの負荷分散が可能になる。

●大規模なトラフィックに対応：
PCやスマホからアクセスがあったら一旦クラウドロードバランシングが受け取り、それをインスタンスグループにそれぞれ負荷分散していく、というイメージ。

## Cloud DNS
- スケーラブルで信頼性の高いドメインネームシステム（DNS）の機能を提供する。

●クラウドロードバランサーとの紐付け：
クラウドロードバランサーのIPとドメインを紐づけて、ドメイン経由でクラウドロードバランサーにアクセスできるようにする。

## Cloud Functions
- 関数単位でのデプロイ
- サーバレス
- 自動スケーリング
- 課金：コードを実行した時間分のみ課金される。
- 無料枠：1か月あたり200万回の呼び出しが無料。遊びで使うなら基本的に無料枠でおさまりそう（「メモリ」は一番小さい128MB推奨）

●用語：
プロキシ：インターネットに接続する際に、出入り口で中継をしているサーバーのこと。

●使用する際に：
「メモリ」ちょっと使うぐらいならメモリは128MBで十分
「トリガー」にHTTPを指定するとURLが生成されて、そのURLにアクセスすると指定の関数が実行できる仕組み
「ランタイム」に言語を指定
コードプレビューのところでコードを変更したり、ライブラリの依存関係を指定することができる

## Google App Engine(GAE)
- ソースコードを準備しておけば、スケールアップやインスタンス管理を全てやってくれる。
- httpsが無料で使える、瞬間スケールアウトしてくれるのが特徴
- ロードバランサーからインスタンスグループまで全部GAEが管理してくれる
- 課金体制：StandardとFlexible。基本的にはスタンダード環境を使い、それで無理そうならフレキシブル環境を使うようにすと良い
- 無料枠：1日あたり28インスタンス時間。普通に使うと24インスタンス時間+スケールアウト4時間分まで無料になる。つかわれなければ基本無料で運用できる。５GBのクラウドストレージや100件のメール、共有Mencashedなど。

## Cloud Datastore
- NoSQLのスケールするデータベース
- MySQLなどのDBは基本スケールできないが、NoSQLのDBはスケールできルため大量の負荷に対応できる。

# おわりに
今回色々なサービスを俯瞰してみたので、「何をやりたいのか」をベースにサービスを活用するとができそうです。特に「GAE」や「Cloud Function」は導入しやすそうに思いました。