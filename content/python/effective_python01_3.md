---
title: "[Effective Python]3 str型とbytes型"
date: 2021-01-19
lead: "「Effective python第２版」の学習備忘録"
categories:
  - "Effective Python"
---

# はじめに
この記事は「Effective Python 第二版」の学習の備忘録です。

**１章 Pythonic思考**  
>Pythonコミュニティでは、特定のスタイルに沿ったコードを表すのにPythonicという形容詞を使います。Pythonのイディオムは、この言語を使い仲間と作業する経験から時間をかけて発展してきました。１章では、Pythonで最も中心的な共通的に使われる最良の方法を扱います。（まえがき xii より引用）

（目次）
- 項目1 使用するPythonのバージョンを知っておく
- 項目2 PEP8スタイルガイドに従う
- **項目3 bytesとstrの違いを知っておく**
- 項目4 Cスタイルフォーマット文字列とstr.formatは使わずf 文字列で埋め込む
- 項目5 複雑な式の代わりにヘルパー関数を書く
- 項目6 インデックスではなく複数代入アンパックを使う
- 項目7 rangeではなくenumerateを使う
- 項目8 イテレータを並列に処理するにはzipを使う
- 項目9 forループとwhileループの後のelseブロックは使わない
- 項目10 代入式で繰り返しを防ぐ



## 項目3 bytesとstrの違いを知っておく
Python3では、文字列データ型を表すのにstr型とbytes型の２種類があります。
str型は「テキストデータ」で、bytes型は「バイナリデータ」
それぞれの型は演算子で一緒に扱うことが一緒にできないので、

## 解説
str型とbytes型についてはわかりづらかったので、前提知識を整理してみました。  

> strのインスタンスはテキスト文字を表すUnicodeコードポイントを含む
> bytesのインスタンスは生の符号なし８ビット値。通常はASCCIIエンコーディング

コンピュータの全般的な知識として、テキストデータとバイナリデータという考え方と、エンコーディングというものがあるので、それらについて整理します。

### （１）テキストデータとバイナリデータ
パソコンで扱うことのできるファイルは大きく分けるとこの２種類になります。  

- 「テキストデータ」は、メモ帳などのテキストエディタで開くことができる、僕らが読めるような文字データ
- 「バイナリデータ」は、そのほか画像、動画、圧縮ファイルなど文字以外を扱っている他の全てのデータ

これはコンピュータの仕組みによる区別です。  
コンピュータが処理することのできるデータは、0か1の集まりである「バイナリコード」になります。この0か1という最小単位がビットで、8ビットをひとまとまりにしたバイトという単位が使われています。  

このような0と1からなるビットで構成されているデータが、コンピュータが読める「バイナリデータ」です。  
一方で、このデータは僕らが目で見ても解読不能なので、日本語なりなんなりの文字で書かれている必要があります。  
そのビットと文字との対応表である「文字コード表」を作ることで、僕らが理解できる「テキストデータ」に変換することができます。  

厳密にいうと、テキストデータもバイナリデータの一種です。

### （２）文字コード表とエンコード
0と1からなるバイナリデータから、人間の読めるテキストデータに翻訳するためにあるのが「文字コード表」です。  
そしてこの文字コード表に基づいて翻訳する作業のことを「エンコード」と呼びます。エンコードするときに、どの文字コード表を元にデータを変換するのかを指定します。

よく文字化けの問題が起こりますが、その原因がここにあります。翻訳に使用すべき文字コード表と、実際に使用する文字コード表が違ってしまっているのが原因です。  

**文字コードの種類**
| 文字コード | 解説 |
| :--- | :--- |
| ASCIIコード | アルファベット、数字、記号、空白文字、制御文字などを表現。ISOで国際標準になっている |
| Unicode | アルファベット、漢字、カナ、アラビア文字など世界中の文字を表現。ISOで規格化されている |

書籍のこの項目の最後の方に「cp1252」という文字コードが出てきますが、これはラテン文字との対応づけをするためのコード表、かと思います。

参考： [よく使われる文字コード一覧と特徴 | UX MILK](https://uxmilk.jp/46875)

**エンコードとデコード**
どちらがどちらか案外こんがらがってしまう言葉です。

- 「エンコード」は元のデータを別のフォーマットに変換すること。符号化、変換、圧縮
- 「デコード」は元のデータに戻すこと。復号化、解析

動画のファイル変換をするときにもエンコード、デコードという表現がよく使われますね。


### Python3におけるbytes型とstr型
[TODO]追記
コンピュータの仕組みを整理したので、次はPython3での使われ方を整理しておきます。  
bytes型とstr型は、どちらも文字列データを表しています。

書籍の表現を抜き出してみると、

> bytesのインスタンスは、生の符号なし8ビット値からなり、通常はASCIIエンコーディングで表示されます
> strのインスタンスはテキスト文字を表すUnicodeコードポイントを含みます
> strインスタンスはバイナリエンコーディングを持たず、bytesインスタンスはテキストエンコーディングを持たない

表現が難しいですが、bytes型もstr型もは裏側では0と1の数字からなるデータであることは共通していますが、

- bytes型が出力されるときには「ASCIIコード」でエンコードされて出力される
- str型が出力されるときには「Unicode」でエンコードされて出力される


### (備考)repr()関数とprint()関数
[TODO]追記
どちらもオブジェクトを文字列で表現する組み込み関数です。 

### (備考)特殊メソッド__repr__()と__str__()
対話モードやJupyter Notebookでオブジェクト名だけを実行したときと、`print()`関数を実行したときとでは、それぞれオブジェクトの内容が出力されます。  
同じような出力結果になりますが、裏側では違う処理が行われていて、クラスに定義されている特殊メソッド`__repr__()`と`__str__()`が働いています。  
オブジェクト名のみ入力したときには`__repr__()`が呼ばれ、組み込み関数`print()`を実行したときには`__str__()`が呼ばれています。  

簡単なイメージとして`__repr__()`はデバッグ向けの文字列、`__str__()`はユーザーが見るための文字列、という感じです。もし`__str__()`が実装されていない場合は`__repr__()`が先に呼ばれるようです。

## 感想


---
## MEMO
【参考記事】
- [コンピュータの仕組み ～テキストファイルとバイナリファイル～｜カルテットコミュニケーションズ](https://quartet-communications.com/info/topics/3182#:~:text=%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E3%81%AF2%E7%A8%AE%E9%A1%9E%E3%81%97%E3%81%8B%E3%81%AA%E3%81%84,-%E3%83%91%E3%82%BD%E3%82%B3%E3%83%B3%E3%81%A7%E6%89%B1%E3%81%86&text=%E3%81%99%E3%81%AA%E3%82%8F%E3%81%A1%E3%80%81%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A8%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A7%E3%81%99%E3%80%82&text=%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A8%E3%81%AF%E3%80%81%20%E6%96%87%E5%AD%97,%E6%9B%B8%E3%81%8B%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%80%82&text=%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A8%E3%81%AF%E3%80%81%20%E3%81%9D%E3%82%8C%E4%BB%A5%E5%A4%96%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%99%E3%81%B9%E3%81%A6%E3%80%82)
- [YouTube](https://www.youtube.com/watch?v=o7BGn6HpcHw)
- [よく使われる文字コード一覧と特徴 | UX MILK](https://uxmilk.jp/46875)
- [「エンコード」と「デコード」の違い｜「分かりそう」で「分からない」でも「分かった」気になれるIT用語辞典](https://wa3.i-3-i.info/diff397data.html)

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=massasquash08-22&m=amazon&o=9&p=8&l=as1&IS1=1&detail=1&asins=4873119170&linkId=b01ad363c615cc9408dfcc360b1a85de&bc1=ffffff&amp;lt1=_top&fc1=333333&lc1=0066c0&bg1=ffffff&f=ifr"></iframe>

---