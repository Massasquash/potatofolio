---
title: "[退屈Python]7章 正規表現によるパターンマッチング"
date: 2021-01-29T19:02:28+09:00
lead: "「退屈なことはPythonにやらせよう」の学習備忘録"
categories:
  - "退屈Python"
---

# はじめに
この記事はO’Reilly「退屈なことはPythonにやらせよう」の学習の備忘録です。

## 正規表現Regexオブジェクト
Regexオブジェクトの生成

```python
import re

phone_num_regex = re.compile(r'\d\d\d-\d\d\d-\d\d\d\d')
```


## 正規表現に用いる記号

### 出現回数と繰り返し系の表現
- 文字集合の後にくっつける記号
- 正確には「文字」 -> 「グループ」。正規表現の中で`()`で括られたものが１グループになる。

|  文字  |  説明  |
| ---- | ---- |
|  ?  |  直前の文字の0回か1回の出現にマッチ |
|  *  |  直前の文字の0回以上の出現にマッチ  |
|  +  |  直前の文字の1文字以上の出現にマッチ  |
|  {n}  |  直前の文字のn回の出現にマッチ。例えば[0-9]{3}で3桁の数字 |
|  {n,}  |  直前の文字をn回以上の出現にマッチ。例えば[0-9]{3,}で3桁以上の数字 |
|  {m, n}  |  直前の文字をm〜n回の出現にマッチ。例えば[0-9]{3, 5}で3〜5桁の数字 |

### 文字集合
|  文字  |  説明  |
| ---- | ---- |
|  .  |  ワイルドカード。改行以外の１文字  |
|  \w  |  文字（大文字/小文字の英字・数字・アンダースコア）。 [A-Za-z0-9]と同じ  |
|  \W  |  文字（大文字/小文字の英字・数字・アンダースコア）以外。 [^\w]と同じ  |
|  \d  |  数字。 [0-9]と同じ  |
|  \D  |  数字以外。 [^0-9]と同じ  |
|  \s  |  空白文字に一致  |
|  \S  |  空白文字以外に一致（[^\s]と同意）  |




## スニペット
### 
```python
# 改行も含めて複数行をマッチ
/[\s\S]*/
```


### 電話番号とメールアドレスの正規表現
[サンプルコード](https://github.com/oreilly-japan/automatestuff-ja/blob/master/ch07/phoneAndEmail.py)より一部変更して（書籍版に記載されているバージョン）記載させていただきます。

```python
# 日本の電話番号用の正規表現
# （市外局番が0から始まる1〜4桁、市内局番が1〜4桁、加入者番号4桁）
phone_regex = re.compile(r'''
  (\d{1,4}|\(\d{1,4}\))  # 市外局番
  (\s|-)           # 区切り
  (\d){1,4})            # ３桁の番号
  (\s|-)           # 区切り
  (\d{3,4})             # ４桁の番号
  (\s*(ext|x|ext.)\s*(\d{2, 5}))?  # 内線番号
  ''', re.VERBOSE)


# 電子メールの正規表現
phone_regex = re.compile(r'''
  [a-zA-Z0-9._%+-]+   # ユーザー名
  @
  [a-zA-Z0-9.-]+      # ドメイン名
  (\.[a-zA-Z]{2,4})  # ドットなんとか
  ''', re.VERBOSE)
```

# おわりに


---
## MEMO
【参考書籍】
- 公式Web版（英語）[Automate the Boring Stuff with Python](https://automatetheboringstuff.com/)
- 公式サンプルコード [GitHub - oreilly-japan/automatestuff-ja: 『退屈なことはPythonにやらせよう』のリポジトリ](https://github.com/oreilly-japan/automatestuff-ja)
---